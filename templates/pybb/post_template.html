{% load i18n pybb_tags staticfiles %}

{% pybb_get_profile user=post.user as post_user_profile %}
{% pybb_get_profile user=user as user_profile %}


    <tr class="post-row">
         <td class="post-info" style="width:10%">
            {% include "pybb/avatar.html" with user=post.user %}
        </td>
        <td style="width:10%;">

            <div class="post-author">
                <span style="font-weight:bold;">{{ post_user_profile.get_first_last }}</span>
                <div>
                  {% if user|pybb_may_edit_post:post %}
                      <a href="{% url 'pybb:edit_post' pk=post.id %}">{% trans 'Edit' %}</a>
                  {% endif %}
                  /
                  {% if user|pybb_may_delete_post:post %}
                      <a onclick="pybb_delete_post('{% url 'pybb:delete_post' post.id %}',
                              'post-{{ post.id }}', '{% trans 'Delete post?' as txt %}{{ txt|escapejs }}'); return false;"
                         href="{% url 'pybb:delete_post' post.id %}">{% trans 'Delete' %}</a>
                  {% endif %}
                </div>

                {% comment %}
                <div class="post-controls">
                    {% if user|pybb_may_edit_post:post %}
                        <a href="{% url 'pybb:edit_post' pk=post.id %}">{% trans 'Edit' %}</a>
                    {% endif %}
                    {% if user|pybb_may_delete_post:post %}
                        <a onclick="pybb_delete_post('{% url 'pybb:delete_post' post.id %}',
                                'post-{{ post.id }}', '{% trans 'Delete post?' as txt %}{{ txt|escapejs }}'); return false;"
                           href="{% url 'pybb:delete_post' post.id %}">{% trans 'Delete' %}</a>
                    {% endif %}
                    {% if post.on_moderation and user.is_moderator %}
                        <a href="{% url 'pybb:moderate_post' pk=post.id %}">{% trans 'Approve post' %}</a>
                    {% endif %}
                    {% if user.is_moderator %}
                        <a href="{% url 'pybb:move_post' pk=post.id %}">{% if post.is_topic_head %}{% trans 'Move' %}{% else %}{% trans "Split" %}{% endif %}</a>
                    {% endif %}

                    {% if user|pybb_may_admin_post:post %}
                        <a href="{% url 'admin:pybb_post_change' post.id %}">{% trans 'Admin' %}</a>
                    {% endif %}

                </div>
                {% endcomment %}
                <!--<a href="{{ post_user_profile.get_absolute_url }}"> -->
                    <!-- <span class="post-username" style="font-weight:lighter;">{{ post_user_profile.get_display_name }}</span> -->
                <!-- </a> -->


            </div>
        </td>
      <td style="width:12%">
          <span style="font-weight:normal;">{{ post.created }}</span>
        </td>
        <td class="rank" style="width:5%;">
            {% if post_user_profile.rank %}
                <div class="rank">
                    {% blocktrans with rank=post_user_profile.rank %}Rank: {{ rank }}{% endblocktrans %}
                    {% if user.is_authenticated and user != post.user %}
                        <a href="#" class="vote" rel="{{ post_user_profile.get_vote_up_url }}">+</a>
                        <a href="#" class="vote" rel="{{ post_user_profile.get_vote_down_url }}">-</a>
                    {% endif %}
                </div>
            {% endif %}

            {% comment %}
            <div class="post-controls">
                {% if user|pybb_may_edit_post:post %}
                    <a href="{% url 'pybb:edit_post' pk=post.id %}">{% trans 'Edit' %}</a>
                {% endif %}
                {% if user|pybb_may_delete_post:post %}
                    <a onclick="pybb_delete_post('{% url 'pybb:delete_post' post.id %}',
                            'post-{{ post.id }}', '{% trans 'Delete post?' as txt %}{{ txt|escapejs }}'); return false;"
                       href="{% url 'pybb:delete_post' post.id %}">{% trans 'Delete' %}</a>
                {% endif %}
                {% if post.on_moderation and user.is_moderator %}
                    <a href="{% url 'pybb:moderate_post' pk=post.id %}">{% trans 'Approve post' %}</a>
                {% endif %}
                {% if user.is_moderator %}
                    <a href="{% url 'pybb:move_post' pk=post.id %}">{% if post.is_topic_head %}{% trans 'Move' %}{% else %}{% trans "Split" %}{% endif %}</a>
                {% endif %}

                {% if user|pybb_may_admin_post:post %}
                    <a href="{% url 'admin:pybb_post_change' post.id %}">{% trans 'Admin' %}</a>
                {% endif %}

            </div>
            {% endcomment %}
        </td>
        <td>
            <div class="d-inline" style="line-height:40px; verticle-align:middle; background-color:#22EA7F; color:white; padding-top:7px; padding-bottom: 7px; padding-right: 9px; padding-left: 9px; margin-left:-30px; margin-right:20px;">{{ topic.name.0 | upper }}  </div>
        </td>
        <td class="post-content">
            {{ post.body_html|safe }}

            {% if not user.is_authenticated or user_profile.show_signatures %}
                {% if post_user_profile.signature %}
                    <div class="post-signature">
                        {{ post_user_profile.signature_html|safe }}
                    </div>
                {% endif %}
            {% endif %}

            <!--
            {% if post.updated %}
                <div class="updated-message">{% trans 'Edited' %} {% pybb_time post.updated %}</div>
            {% endif %}
        -->

            {% comment %}
                    {% if post.attachment_cache %}
                    {% for attach in post.attachment_cache %}
                    <br/>
                    {% trans 'Attachment' %}{% trans ':' %} <a href="{{ attach.get_absolute_url }}">{{ attach.name }}</a> ({{ attach.size_display }})
                    {% endfor %}
                    {% endif %}
            {% endcomment %}

            <!--
            <div class="post-related">
                {% if user|pybb_may_create_post:post.topic %}
                    <a href="{% url 'pybb:add_post' topic.id %}?quote_id={{ post.id }}" class="quote-link">{% trans 'quote' %}</a>
                    <a href="#" class="quote-selected-link">{% trans 'quote selected' %}</a>
                {% endif %}
                <div class="attachments">
                    {% for attachment in post.attachments.all %}
                        <a href="{{ attachment.file.url }}"><img src="{% static 'pybb/img/attachment.png' %}"> {{ attachment.size_display }}</a>
                    {% endfor %}
                </div>
            </div>
        -->
        </td>
    </tr>
